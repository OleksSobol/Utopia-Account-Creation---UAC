[uwsgi]
module = api_wsgi:app

# Virtual Environment Configuration
virtualenv = /home/gnapi/UAC-Utopia-Account-Creation/venv

# Security Settings
# uid = gnapi    # Commented out - causes permission issues when already running as gnapi
# gid = gnapi    # Commented out - causes permission issues when already running as gnapi
umask = 002

# Process Management
master = true
processes = 5
max-requests = 1000
max-requests-delta = 50
harakiri = 60
vacuum = true
die-on-term = true

# Socket Configuration
socket = api_callback.sock
chmod-socket = 666
# chown-socket = gnapi:nginx  # Commented out - causes permission errors
vacuum = true

# Logging Configuration
logto = api_callback.log
log-date = true
# log-maxsize = 50000000  # Commented out - causes lseek errors with stdout
# logfile-chmod = 644

# Security & Performance
disable-logging = false
ignore-sigpipe = true
ignore-write-errors = true
disable-write-exception = true

# Memory Management
reload-on-rss = 512
evil-reload-on-rss = 1024

# Worker Management
cheaper = 2
cheaper-initial = 2
cheaper-step = 1
cheaper-algo = busyness
cheaper-overload = 5

# Threading (if needed)
# enable-threads = true
# threads = 2

# Stats (optional - for monitoring)
# stats = 127.0.0.1:9191

# Buffer sizes
buffer-size = 32768
post-buffering = 8192

# Timeouts
socket-timeout = 10
http-timeout = 60

